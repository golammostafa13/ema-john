{"ast":null,"code":"var _jsxFileName = \"/home/mostafa/Documents/ema-john/ema-john/src/components/Login/Login.js\",\n    _s = $RefreshSig$();\n\nimport firebase from \"firebase/app\";\nimport \"firebase/auth\";\nimport { useContext, useState } from \"react\";\nimport { UserContext } from \"../../App\";\nimport '../Cart/FirebaseConfig';\nimport firebaseConfig from \"../Cart/FirebaseConfig\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfirebase.initializeApp(firebaseConfig);\n\nfunction Login() {\n  _s();\n\n  const googleProvider = new firebase.auth.GoogleAuthProvider();\n  const fbProvider = new firebase.auth.FacebookAuthProvider();\n  const [user, setUser] = useState({\n    name: '',\n    email: '',\n    photoURL: '',\n    password: '',\n    isSignedIn: false,\n    error: '',\n    success: false\n  });\n  const [loggedInUser, setLoggedInUser] = useContext(UserContext);\n  const [newUser, setNewUser] = useState(false);\n\n  const handleSignIn = () => {\n    firebase.auth().signInWithPopup(googleProvider).then(res => {\n      const {\n        displayName,\n        photoURL,\n        email\n      } = res.user;\n      const newUser = {\n        name: displayName,\n        email,\n        photoURL,\n        password: '',\n        isSignedIn: true,\n        error: ''\n      };\n      setUser(newUser);\n    }).catch(err => {\n      console.log(err.message);\n    });\n  };\n\n  const handleSignOut = () => {\n    const newUser = {\n      name: '',\n      email: '',\n      password: '',\n      photoURL: '',\n      isSignedIn: false,\n      error: '',\n      success: true\n    };\n    setUser(newUser);\n  };\n\n  const handleFbSignIn = () => {\n    firebase.auth().signInWithPopup(fbProvider).then(result => {\n      // The signed-in user info.\n      var user = result.user;\n      console.log(user); // ...\n    }).catch(error => {\n      // Handle Errors here.\n      var errorMessage = error.message;\n      console.log(errorMessage); // ...\n    });\n  };\n\n  const handleSubmit = e => {\n    // console.log('hello');\n    if (newUser && user.email && user.password) {\n      firebase.auth().createUserWithEmailAndPassword(user.email, user.password).then(res => {\n        // Signed in \n        const newUserInfo = { ...user\n        };\n        newUserInfo.success = true;\n        newUserInfo.error = '';\n        setUser(newUserInfo);\n        updateUserName(user.name); // ...\n      }).catch(error => {\n        // var errorCode = error.code;\n        var errorMessage = error.message;\n        const newUserInfo = { ...user\n        };\n        newUserInfo.error = errorMessage;\n        newUserInfo.success = false;\n        setUser(newUserInfo);\n      });\n    }\n\n    if (!newUser && user.email && user.password) {\n      firebase.auth().signInWithEmailAndPassword(user.email, user.password).then(res => {\n        // Signed in \n        const newUserInfo = { ...user\n        };\n        newUserInfo.success = true;\n        newUserInfo.error = '';\n        setUser(newUserInfo);\n        setLoggedInUser(newUserInfo);\n        console.log(res.user); // ...\n      }).catch(error => {\n        // var errorCode = error.code;\n        var errorMessage = error.message;\n        const newUserInfo = { ...user\n        };\n        newUserInfo.error = errorMessage;\n        newUserInfo.success = false;\n        setUser(newUserInfo);\n      });\n    }\n\n    e.preventDefault();\n  };\n\n  const updateUserName = name => {\n    var user = firebase.auth().currentUser;\n    user.updateProfile({\n      displayName: name\n    }).then(function () {\n      console.log(\"Updated user info: \" + name);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  const handleBlur = e => {\n    // console.log(e.target.name, e.target.value);\n    let isFieldValid = true;\n\n    if (e.target.name === \"email\") {\n      let isEmailValid = /\\S+@\\S+\\.\\S/.test(e.target.value);\n      isFieldValid = isEmailValid;\n    }\n\n    if (e.target.name === \"password\") {\n      const checkLength = e.target.value.length > 6;\n      const numberCheck = /\\d{1}/.test(e.target.value);\n      isFieldValid = checkLength && numberCheck;\n    }\n\n    if (isFieldValid) {\n      var _e$target, _e$target2;\n\n      const newUserInfo = { ...user\n      };\n      newUserInfo[e === null || e === void 0 ? void 0 : (_e$target = e.target) === null || _e$target === void 0 ? void 0 : _e$target.name] = e === null || e === void 0 ? void 0 : (_e$target2 = e.target) === null || _e$target2 === void 0 ? void 0 : _e$target2.value; // console.log(newUserInfo);\n\n      setUser(newUserInfo);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      textAlign: 'center'\n    },\n    children: [user.isSignedIn ? /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleSignOut,\n      children: \"Sign Out\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleSignIn,\n      children: \"Sign In with google\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 61\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleFbSignIn,\n      children: \"Sign in with facebook\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"checkbox\",\n        onChange: () => setNewUser(!newUser)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"New User Sign in\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        children: [newUser && /*#__PURE__*/_jsxDEV(\"input\", {\n          onBlur: handleBlur,\n          name: \"name\",\n          type: \"text\",\n          placeholder: \"Your name\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 23\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 107\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          onBlur: handleBlur,\n          name: \"email\",\n          type: \"email\",\n          placeholder: \"Enter email\",\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 107\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          onBlur: handleBlur,\n          name: \"password\",\n          type: \"password\",\n          placeholder: \"password\",\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 110\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          children: newUser ? 'Sign Up' : 'Sign In'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          color: 'red'\n        },\n        children: user.error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 9\n      }, this), user.success && /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          color: 'green'\n        },\n        children: [\"User \", !newUser ? 'signed in' : 'created', \" successfully\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 26\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 150,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Login, \"iLawBOKirrQTpQZGuPdqV3u0ioQ=\");\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/home/mostafa/Documents/ema-john/ema-john/src/components/Login/Login.js"],"names":["firebase","useContext","useState","UserContext","firebaseConfig","initializeApp","Login","googleProvider","auth","GoogleAuthProvider","fbProvider","FacebookAuthProvider","user","setUser","name","email","photoURL","password","isSignedIn","error","success","loggedInUser","setLoggedInUser","newUser","setNewUser","handleSignIn","signInWithPopup","then","res","displayName","catch","err","console","log","message","handleSignOut","handleFbSignIn","result","errorMessage","handleSubmit","e","createUserWithEmailAndPassword","newUserInfo","updateUserName","signInWithEmailAndPassword","preventDefault","currentUser","updateProfile","handleBlur","isFieldValid","target","isEmailValid","test","value","checkLength","length","numberCheck","textAlign","color"],"mappings":"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","sourcesContent":["import firebase from \"firebase/app\";\nimport \"firebase/auth\";\nimport { useContext, useState } from \"react\";\nimport { UserContext } from \"../../App\";\nimport '../Cart/FirebaseConfig';\nimport firebaseConfig from \"../Cart/FirebaseConfig\";\n\nfirebase.initializeApp(firebaseConfig);\n\nfunction Login() {\n  const googleProvider = new firebase.auth.GoogleAuthProvider();\n  const fbProvider = new firebase.auth.FacebookAuthProvider();\n  const [user, setUser] = useState({\n    name: '',\n    email: '',\n    photoURL: '',\n    password: '',\n    isSignedIn: false,\n    error: '',\n    success: false,\n  })\n  const [loggedInUser, setLoggedInUser] = useContext(UserContext);\n  const [newUser, setNewUser] = useState(false);\n  const handleSignIn = () =>{\n    firebase.auth().signInWithPopup(googleProvider)\n    .then((res)=>{\n      const {displayName, photoURL, email} = res.user;\n      const newUser = {\n        name: displayName,\n        email,\n        photoURL,\n        password: '',\n        isSignedIn: true,\n        error:'',\n      }\n      setUser(newUser);\n    })\n    .catch((err)=>{\n      console.log(err.message);\n    })\n  }\n  const handleSignOut = () =>{\n    const newUser = {\n      name: '',\n      email: '',\n      password: '',\n      photoURL: '',\n      isSignedIn: false,\n      error: '',\n      success: true\n    };\n    setUser(newUser);\n  }\n\n  const  handleFbSignIn = () => {\n    firebase\n    .auth()\n    .signInWithPopup(fbProvider)\n    .then((result) => {\n\n      // The signed-in user info.\n      var user = result.user;\n      console.log(user);\n      // ...\n    })\n    .catch((error) => {\n      // Handle Errors here.\n      var errorMessage = error.message;\n      console.log(errorMessage);\n      // ...\n    });\n  }\n\n  const handleSubmit = (e)=>{\n    // console.log('hello');\n    if(newUser && user.email && user.password){\n      firebase.auth().createUserWithEmailAndPassword(user.email, user.password)\n      .then((res) => {\n        // Signed in \n        const newUserInfo = {...user};\n        newUserInfo.success = true;\n        newUserInfo.error = '';\n        setUser(newUserInfo);\n        updateUserName(user.name);\n        // ...\n      })\n      .catch((error) => {\n        // var errorCode = error.code;\n        var errorMessage = error.message;\n        const newUserInfo = {...user};\n        newUserInfo.error = errorMessage;\n        newUserInfo.success = false;\n        setUser(newUserInfo);\n      });\n    }\n    if(!newUser && user.email && user.password){\n      firebase.auth().signInWithEmailAndPassword(user.email, user.password)\n    .then((res) => {\n      // Signed in \n      const newUserInfo = {...user};\n      newUserInfo.success = true;\n      newUserInfo.error = '';\n      setUser(newUserInfo);\n      setLoggedInUser(newUserInfo);\n      console.log(res.user);\n      // ...\n    })\n    .catch((error) => {\n      // var errorCode = error.code;\n      var errorMessage = error.message;\n      const newUserInfo = {...user};\n      newUserInfo.error = errorMessage;\n      newUserInfo.success = false;\n      setUser(newUserInfo);\n    });\n    }\n    e.preventDefault();\n  }\n  const updateUserName = (name) =>{\n    var user = firebase.auth().currentUser;\n\n    user.updateProfile({\n      displayName: name,\n    }).then(function() {\n      console.log(\"Updated user info: \" + name);\n    }).catch(function(error) {\n      console.log(error);\n    });\n  }\n  const handleBlur = (e) =>{\n    // console.log(e.target.name, e.target.value);\n    let isFieldValid=true;\n    if(e.target.name===\"email\"){\n       let isEmailValid = /\\S+@\\S+\\.\\S/.test(e.target.value);\n       isFieldValid = isEmailValid;\n    }if(e.target.name === \"password\"){\n        const checkLength = e.target.value.length > 6;\n        const numberCheck = /\\d{1}/.test(e.target.value);\n        isFieldValid = checkLength && numberCheck;\n      }\n    if(isFieldValid){\n      const newUserInfo = {...user};\n      newUserInfo[e?.target?.name] = e?.target?.value;\n      // console.log(newUserInfo);\n      setUser(newUserInfo);\n    }\n  }\n \n  return (\n    <div style={{textAlign: 'center'}}>\n      { user.isSignedIn ?\n        <button onClick={handleSignOut}>Sign Out</button> : <button onClick={handleSignIn}>Sign In with google</button>\n      } \n      {/* {user.isSignedIn && } */}\n      <br></br>\n      <button onClick={handleFbSignIn}>Sign in with facebook</button>\n      <div>\n        <input type=\"checkbox\" onChange={()=>setNewUser(!newUser)}></input> \n        <label>New User Sign in</label>\n        <form onSubmit={handleSubmit}>\n          {newUser && <input onBlur={handleBlur} name=\"name\" type=\"text\" placeholder=\"Your name\"></input>}<br></br>\n          <input onBlur={handleBlur} name=\"email\" type=\"email\" placeholder=\"Enter email\" required></input><br></br>\n          <input onBlur={handleBlur} name=\"password\" type=\"password\" placeholder=\"password\" required></input><br></br>\n          <button type=\"submit\">{newUser?'Sign Up':'Sign In'}</button>\n        </form>\n        <p style={{color: 'red'}}>{user.error}</p>\n        {user.success && <p style={{color: 'green'}}>User {!newUser?'signed in': 'created'} successfully</p>}\n        \n      </div>\n    </div>\n  );\n}\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}