{"ast":null,"code":"var _jsxFileName = \"/home/mostafa/Documents/ema-john/ema-john/src/components/Login/Login.js\",\n    _s = $RefreshSig$();\n\nimport firebase from \"firebase/app\";\nimport \"firebase/auth\";\nimport { useContext, useState } from \"react\";\nimport { useHistory, useLocation } from \"react-router\";\nimport { UserContext } from \"../../App\";\nimport '../Cart/FirebaseConfig';\nimport firebaseConfig from \"../Cart/FirebaseConfig\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfirebase.initializeApp(firebaseConfig);\n\nfunction Login() {\n  _s();\n\n  const googleProvider = new firebase.auth.GoogleAuthProvider();\n  const fbProvider = new firebase.auth.FacebookAuthProvider();\n  const [user, setUser] = useState({\n    name: '',\n    email: '',\n    photoURL: '',\n    password: '',\n    isSignedIn: false,\n    error: '',\n    success: false\n  });\n  const [loggedInUser, setLoggedInUser] = useContext(UserContext);\n  const [newUser, setNewUser] = useState(false);\n  const history = useHistory();\n  const location = useLocation();\n  let {\n    from\n  } = location.state || {\n    from: {\n      pathname: \"/\"\n    }\n  };\n\n  const handleSignIn = () => {\n    firebase.auth().signInWithPopup(googleProvider).then(res => {\n      const {\n        displayName,\n        photoURL,\n        email\n      } = res.user;\n      const newUser = {\n        name: displayName,\n        email,\n        photoURL,\n        password: '',\n        isSignedIn: true,\n        error: ''\n      };\n      setUser(newUser);\n    }).catch(err => {\n      console.log(err.message);\n    });\n  };\n\n  const handleSignOut = () => {\n    const newUser = {\n      name: '',\n      email: '',\n      password: '',\n      photoURL: '',\n      isSignedIn: false,\n      error: '',\n      success: true\n    };\n    setUser(newUser);\n  };\n\n  const handleFbSignIn = () => {\n    firebase.auth().signInWithPopup(fbProvider).then(result => {\n      // The signed-in user info.\n      var user = result.user;\n      console.log(user); // ...\n    }).catch(error => {\n      // Handle Errors here.\n      var errorMessage = error.message;\n      console.log(errorMessage); // ...\n    });\n  };\n\n  const handleSubmit = e => {\n    // console.log('hello');\n    if (newUser && user.email && user.password) {\n      firebase.auth().createUserWithEmailAndPassword(user.email, user.password).then(res => {\n        // Signed in \n        const newUserInfo = { ...user\n        };\n        newUserInfo.success = true;\n        newUserInfo.error = '';\n        setUser(newUserInfo);\n        updateUserName(user.name); // ...\n      }).catch(error => {\n        // var errorCode = error.code;\n        var errorMessage = error.message;\n        const newUserInfo = { ...user\n        };\n        newUserInfo.error = errorMessage;\n        newUserInfo.success = false;\n        setUser(newUserInfo);\n      });\n    }\n\n    if (!newUser && user.email && user.password) {\n      firebase.auth().signInWithEmailAndPassword(user.email, user.password).then(res => {\n        // Signed in \n        const newUserInfo = { ...user\n        };\n        newUserInfo.success = true;\n        newUserInfo.error = '';\n        setUser(newUserInfo);\n        setLoggedInUser(newUserInfo);\n        history.replace(from); // console.log(res.user);\n        // ...\n      }).catch(error => {\n        // var errorCode = error.code;\n        var errorMessage = error.message;\n        const newUserInfo = { ...user\n        };\n        newUserInfo.error = errorMessage;\n        newUserInfo.success = false;\n        setUser(newUserInfo);\n      });\n    }\n\n    e.preventDefault();\n  };\n\n  const updateUserName = name => {\n    var user = firebase.auth().currentUser;\n    user.updateProfile({\n      displayName: name\n    }).then(function () {\n      console.log(\"Updated user info: \" + name);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  const handleBlur = e => {\n    // console.log(e.target.name, e.target.value);\n    let isFieldValid = true;\n\n    if (e.target.name === \"email\") {\n      let isEmailValid = /\\S+@\\S+\\.\\S/.test(e.target.value);\n      isFieldValid = isEmailValid;\n    }\n\n    if (e.target.name === \"password\") {\n      const checkLength = e.target.value.length > 6;\n      const numberCheck = /\\d{1}/.test(e.target.value);\n      isFieldValid = checkLength && numberCheck;\n    }\n\n    if (isFieldValid) {\n      var _e$target, _e$target2;\n\n      const newUserInfo = { ...user\n      };\n      newUserInfo[e === null || e === void 0 ? void 0 : (_e$target = e.target) === null || _e$target === void 0 ? void 0 : _e$target.name] = e === null || e === void 0 ? void 0 : (_e$target2 = e.target) === null || _e$target2 === void 0 ? void 0 : _e$target2.value; // console.log(newUserInfo);\n\n      setUser(newUserInfo);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      textAlign: 'center'\n    },\n    children: [user.isSignedIn ? /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleSignOut,\n      children: \"Sign Out\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleSignIn,\n      children: \"Sign In with google\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 61\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleFbSignIn,\n      children: \"Sign in with facebook\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"checkbox\",\n        onChange: () => setNewUser(!newUser)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"New User Sign in\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        children: [newUser && /*#__PURE__*/_jsxDEV(\"input\", {\n          onBlur: handleBlur,\n          name: \"name\",\n          type: \"text\",\n          placeholder: \"Your name\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 23\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 107\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          onBlur: handleBlur,\n          name: \"email\",\n          type: \"email\",\n          placeholder: \"Enter email\",\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 107\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          onBlur: handleBlur,\n          name: \"password\",\n          type: \"password\",\n          placeholder: \"password\",\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 110\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          children: newUser ? 'Sign Up' : 'Sign In'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          color: 'red'\n        },\n        children: user.error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 9\n      }, this), user.success && /*#__PURE__*/_jsxDEV(\"p\", {\n        style: {\n          color: 'green'\n        },\n        children: [\"User \", !newUser ? 'signed in' : 'created', \" successfully\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 26\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 157,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Login, \"415DRASeji3IzPrf3jDP/FSZLUY=\", false, function () {\n  return [useHistory, useLocation];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/home/mostafa/Documents/ema-john/ema-john/src/components/Login/Login.js"],"names":["firebase","useContext","useState","useHistory","useLocation","UserContext","firebaseConfig","initializeApp","Login","googleProvider","auth","GoogleAuthProvider","fbProvider","FacebookAuthProvider","user","setUser","name","email","photoURL","password","isSignedIn","error","success","loggedInUser","setLoggedInUser","newUser","setNewUser","history","location","from","state","pathname","handleSignIn","signInWithPopup","then","res","displayName","catch","err","console","log","message","handleSignOut","handleFbSignIn","result","errorMessage","handleSubmit","e","createUserWithEmailAndPassword","newUserInfo","updateUserName","signInWithEmailAndPassword","replace","preventDefault","currentUser","updateProfile","handleBlur","isFieldValid","target","isEmailValid","test","value","checkLength","length","numberCheck","textAlign","color"],"mappings":"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","sourcesContent":["import firebase from \"firebase/app\";\nimport \"firebase/auth\";\nimport { useContext, useState } from \"react\";\nimport { useHistory, useLocation } from \"react-router\";\nimport { UserContext } from \"../../App\";\nimport '../Cart/FirebaseConfig';\nimport firebaseConfig from \"../Cart/FirebaseConfig\";\n\nfirebase.initializeApp(firebaseConfig);\n\nfunction Login() {\n  const googleProvider = new firebase.auth.GoogleAuthProvider();\n  const fbProvider = new firebase.auth.FacebookAuthProvider();\n  const [user, setUser] = useState({\n    name: '',\n    email: '',\n    photoURL: '',\n    password: '',\n    isSignedIn: false,\n    error: '',\n    success: false,\n  })\n  const [loggedInUser, setLoggedInUser] = useContext(UserContext);\n  const [newUser, setNewUser] = useState(false);\n\n  const history = useHistory();\n  const location = useLocation();\n  let { from } = location.state || { from: { pathname: \"/\" } };\n\n  const handleSignIn = () =>{\n    firebase.auth().signInWithPopup(googleProvider)\n    .then((res)=>{\n      const {displayName, photoURL, email} = res.user;\n      const newUser = {\n        name: displayName,\n        email,\n        photoURL,\n        password: '',\n        isSignedIn: true,\n        error:'',\n      }\n      setUser(newUser);\n    })\n    .catch((err)=>{\n      console.log(err.message);\n    })\n  }\n  const handleSignOut = () =>{\n    const newUser = {\n      name: '',\n      email: '',\n      password: '',\n      photoURL: '',\n      isSignedIn: false,\n      error: '',\n      success: true\n    };\n    setUser(newUser);\n  }\n\n  const  handleFbSignIn = () => {\n    firebase\n    .auth()\n    .signInWithPopup(fbProvider)\n    .then((result) => {\n\n      // The signed-in user info.\n      var user = result.user;\n      console.log(user);\n      // ...\n    })\n    .catch((error) => {\n      // Handle Errors here.\n      var errorMessage = error.message;\n      console.log(errorMessage);\n      // ...\n    });\n  }\n\n  const handleSubmit = (e)=>{\n    // console.log('hello');\n    if(newUser && user.email && user.password){\n      firebase.auth().createUserWithEmailAndPassword(user.email, user.password)\n      .then((res) => {\n        // Signed in \n        const newUserInfo = {...user};\n        newUserInfo.success = true;\n        newUserInfo.error = '';\n        setUser(newUserInfo);\n        updateUserName(user.name);\n        // ...\n      })\n      .catch((error) => {\n        // var errorCode = error.code;\n        var errorMessage = error.message;\n        const newUserInfo = {...user};\n        newUserInfo.error = errorMessage;\n        newUserInfo.success = false;\n        setUser(newUserInfo);\n      });\n    }\n    if(!newUser && user.email && user.password){\n      firebase.auth().signInWithEmailAndPassword(user.email, user.password)\n    .then((res) => {\n      // Signed in \n      const newUserInfo = {...user};\n      newUserInfo.success = true;\n      newUserInfo.error = '';\n      setUser(newUserInfo);\n      setLoggedInUser(newUserInfo);\n      history.replace(from);\n      // console.log(res.user);\n      // ...\n    })\n    .catch((error) => {\n      // var errorCode = error.code;\n      var errorMessage = error.message;\n      const newUserInfo = {...user};\n      newUserInfo.error = errorMessage;\n      newUserInfo.success = false;\n      setUser(newUserInfo);\n    });\n    }\n    e.preventDefault();\n  }\n  const updateUserName = (name) =>{\n    var user = firebase.auth().currentUser;\n\n    user.updateProfile({\n      displayName: name,\n    }).then(function() {\n      console.log(\"Updated user info: \" + name);\n    }).catch(function(error) {\n      console.log(error);\n    });\n  }\n  const handleBlur = (e) =>{\n    // console.log(e.target.name, e.target.value);\n    let isFieldValid=true;\n    if(e.target.name===\"email\"){\n       let isEmailValid = /\\S+@\\S+\\.\\S/.test(e.target.value);\n       isFieldValid = isEmailValid;\n    }if(e.target.name === \"password\"){\n        const checkLength = e.target.value.length > 6;\n        const numberCheck = /\\d{1}/.test(e.target.value);\n        isFieldValid = checkLength && numberCheck;\n      }\n    if(isFieldValid){\n      const newUserInfo = {...user};\n      newUserInfo[e?.target?.name] = e?.target?.value;\n      // console.log(newUserInfo);\n      setUser(newUserInfo);\n    }\n  }\n \n  return (\n    <div style={{textAlign: 'center'}}>\n      { user.isSignedIn ?\n        <button onClick={handleSignOut}>Sign Out</button> : <button onClick={handleSignIn}>Sign In with google</button>\n      } \n      {/* {user.isSignedIn && } */}\n      <br></br>\n      <button onClick={handleFbSignIn}>Sign in with facebook</button>\n      <div>\n        <input type=\"checkbox\" onChange={()=>setNewUser(!newUser)}></input> \n        <label>New User Sign in</label>\n        <form onSubmit={handleSubmit}>\n          {newUser && <input onBlur={handleBlur} name=\"name\" type=\"text\" placeholder=\"Your name\"></input>}<br></br>\n          <input onBlur={handleBlur} name=\"email\" type=\"email\" placeholder=\"Enter email\" required></input><br></br>\n          <input onBlur={handleBlur} name=\"password\" type=\"password\" placeholder=\"password\" required></input><br></br>\n          <button type=\"submit\">{newUser?'Sign Up':'Sign In'}</button>\n        </form>\n        <p style={{color: 'red'}}>{user.error}</p>\n        {user.success && <p style={{color: 'green'}}>User {!newUser?'signed in': 'created'} successfully</p>}\n        \n      </div>\n    </div>\n  );\n}\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}